# Node.js Homework Project

## Описание проекта

Проект представляет собой серверное приложение для агрегации данных из CSV файлов, содержащих информацию о расходах различных цивилизаций.

## Формат входных данных (CSV)

-   `id` - ID записи (число)
-   `civ` - цивилизация программиста (люди, желеобразные блобы с Юпитера, летающие макаронные монстры с Альфа Центавра)
-   `developer_id` - уникальный id программиста (от 0 до 10_000_000_000_000)
-   `date` - номер дня в году (от 0 до 364, високосных нет)
-   `spend` - потрачено в кредитах для людей, в желеточках для блобов, в спагеттикоинах для макаронных монстров (от 0 до 1000)

## Цивилизации

Цивилизации имеют следующие id:

-   `humans` - Люди
-   `blobs` - Желеобразные блобы с Юпитера
-   `monsters` - Летающие макаронные монстры с Альфа Центавра

## Невалидные данные

Данные в CSV могут быть невалидны. Строки с такими данными стоит пропускать. Виды невалидных данных:

-   Полностью невалидная строка - такая строка содержит случайный набор символов, запятые в строке отсутствуют
-   Неизвестная цивилизация - значение `civ` отличается от валидных значений (`humans`, `blobs`, `monsters`)
-   Отрицательное значение в поле `spend` - любое число меньше 0

## Формат выходных данных (JSON)

```json
{
  "total_spend_galactic": number,    // общие расходы в галактических кредитах
  "rows_affected": number,           // количество обработанных записей
  "less_spent_at": number,           // день года с минимальными расходами
  "big_spent_at": number,            // день года с максимальными расходами
  "less_spent_value": number,        // минимальная сумма расходов за день
  "big_spent_value": number,         // максимальная сумма расходов за день
  "average_spend_galactic": number,  // средние расходы в галактических кредитах
  "big_spent_civ": string,           // цивилизация с максимальными расходами
  "less_spent_civ": string           // цивилизация с минимальными расходами
}
```

## Доступные команды

### Запуск сервера

```bash
npm start
```

Сервер запускается на стандартном порту Node.js (обычно 3000).

### Генерация CSV файла

```bash
npm run generate-csv
```

Эта команда создаст большой CSV файл с тестовыми данными для последующей обработки.

### Отправка тестового запроса

```bash
npm run send-request
```

Эта команда отправит тестовый запрос к серверу для проверки его работоспособности.

## API Endpoints

### v1/stats:aggregate

Базовая версия эндпоинта для агрегации данных (неэффективная реализация).

## Задачи для реализации

1. Реализация эндпоинта v2/stats:aggregate с использованием objectMode в стримах
2. Реализация эндпоинта v2/stats:aggregate_as_stream для потоковой отправки результатов
3. Создание CLI для проверки эндпоинтов
4. Опциональный рефакторинг кода
